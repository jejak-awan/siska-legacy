import{p as h,B as F,c as a,o as s,s as b,v as B,f as t,t as v,F as L,k as U,n as j}from"./index-Bo0LgBjO.js";const N={class:"image-upload"},H={class:"text-xs text-muted-foreground"},P=["accept","multiple"],W={key:1,class:"space-y-4"},$={key:0,class:"relative"},R=["src"],E={key:1,class:"grid grid-cols-2 md:grid-cols-3 gap-4"},G=["src","alt"],T=["onClick"],K={key:2,class:"text-center"},q={key:2,class:"mt-4"},J={class:"flex items-center space-x-2"},O={class:"flex-1 bg-muted rounded-full h-2"},Q={class:"text-sm text-muted-foreground"},X={key:3,class:"mt-2 text-sm text-red-600"},Z={__name:"ImageUpload",props:{modelValue:{type:[String,Array],default:null},multiple:{type:Boolean,default:!1},accept:{type:String,default:"image/*"},maxSize:{type:Number,default:5},maxWidth:{type:Number,default:1920},maxHeight:{type:Number,default:1080}},emits:["update:modelValue"],setup(l,{emit:M}){const r=l,u=M,k=h(null),y=h(!1),c=h(0),d=h(""),x=()=>{var o;(o=k.value)==null||o.click()},_=o=>{const e=Array.from(o.target.files);e.length>0&&w(e)},A=o=>{const e=Array.from(o.dataTransfer.files);e.length>0&&w(e)},w=async o=>{d.value="";for(const e of o){if(!e.type.startsWith("image/")){d.value="Hanya file gambar yang diperbolehkan";continue}if(e.size>r.maxSize*1024*1024){d.value=`Ukuran file tidak boleh lebih dari ${r.maxSize}MB`;continue}try{y.value=!0,c.value=0;const n=await S(e);if(r.multiple){const i=Array.isArray(r.modelValue)?r.modelValue:[];u("update:modelValue",[...i,n])}else u("update:modelValue",n);c.value=100}catch(n){d.value="Gagal memproses gambar",console.error("Image processing error:",n)}finally{y.value=!1,c.value=0}}},S=o=>new Promise((e,n)=>{const i=new FileReader;i.onload=I=>{const m=new Image;m.onload=()=>{const f=document.createElement("canvas"),D=f.getContext("2d");let{width:p,height:g}=m;if(p>r.maxWidth||g>r.maxHeight){const C=Math.min(r.maxWidth/p,r.maxHeight/g);p*=C,g*=C}f.width=p,f.height=g,D.drawImage(m,0,0,p,g);const z=f.toDataURL("image/jpeg",.8);e(z)},m.onerror=n,m.src=I.target.result},i.onerror=n,i.readAsDataURL(o)}),V=(o=null)=>{if(r.multiple&&Array.isArray(r.modelValue))if(o!==null){const e=[...r.modelValue];e.splice(o,1),u("update:modelValue",e)}else u("update:modelValue",[]);else u("update:modelValue",null)};return F(()=>r.modelValue,o=>{o||(d.value="")}),(o,e)=>(s(),a("div",N,[l.modelValue?(s(),a("div",W,[l.multiple?(s(),a("div",E,[(s(!0),a(L,null,U(l.modelValue,(n,i)=>(s(),a("div",{key:i,class:"relative"},[t("img",{src:n,alt:`Preview ${i+1}`,class:"w-full h-32 object-cover rounded-lg border border-border"},null,8,G),t("button",{onClick:I=>V(i),class:"absolute top-1 right-1 p-1 bg-red-500 text-white rounded-full hover:bg-red-600 transition-colors"},[...e[4]||(e[4]=[t("svg",{class:"h-3 w-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])],8,T)]))),128))])):(s(),a("div",$,[t("img",{src:l.modelValue,alt:"Preview",class:"w-full h-48 object-cover rounded-lg border border-border"},null,8,R),t("button",{onClick:V,class:"absolute top-2 right-2 p-1 bg-red-500 text-white rounded-full hover:bg-red-600 transition-colors"},[...e[3]||(e[3]=[t("svg",{class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])])),l.multiple?(s(),a("div",K,[t("button",{onClick:x,class:"px-4 py-2 text-sm text-primary border border-primary rounded-md hover:bg-primary hover:text-primary-foreground transition-colors"}," Tambah Gambar ")])):b("",!0)])):(s(),a("div",{key:0,onClick:x,onDragover:e[0]||(e[0]=B(()=>{},["prevent"])),onDrop:B(A,["prevent"]),class:"border-2 border-dashed border-input rounded-lg p-6 text-center cursor-pointer hover:border-primary transition-colors"},[e[1]||(e[1]=t("svg",{class:"mx-auto h-12 w-12 text-muted-foreground mb-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})],-1)),e[2]||(e[2]=t("p",{class:"text-sm text-muted-foreground mb-2"}," Klik untuk upload atau drag & drop ",-1)),t("p",H,v(l.accept)+" (maks. "+v(l.maxSize)+"MB) ",1),t("input",{ref_key:"fileInput",ref:k,type:"file",accept:l.accept,multiple:l.multiple,onChange:_,class:"hidden"},null,40,P)],32)),y.value?(s(),a("div",q,[t("div",J,[t("div",O,[t("div",{class:"bg-primary h-2 rounded-full transition-all duration-300",style:j({width:`${c.value}%`})},null,4)]),t("span",Q,v(c.value)+"%",1)])])):b("",!0),d.value?(s(),a("div",X,v(d.value),1)):b("",!0)]))}};export{Z as _};
